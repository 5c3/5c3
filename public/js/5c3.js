// Generated by CoffeeScript 1.3.3
(function() {
  var FiveC3, top,
    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

  top = this;

  FiveC3 = (function() {

    function FiveC3() {
      var typeaheadOptions;
      this.events = [];
      this.typeaheadStrings = [];
      this.resizeSidebar();
      $(window).resize(this.resizeSidebar);
      this.refreshEventData();
      typeaheadOptions = {
        minLenght: 2,
        source: this.typeaheadStrings
      };
      $('.typeahead').typeahead(typeaheadOptions);
    }

    FiveC3.prototype.refreshEventData = function() {
      var _this = this;
      return $.ajax({
        url: 'testdata/schedule.en.xml',
        datatype: 'xml',
        success: function(dataFromServer) {
          _this.events = [];
          return $('event', dataFromServer).each(function(index, eventDom) {
            var evnt;
            evnt = {};
            evnt.start = $('start', eventDom).text();
            evnt.id = $(eventDom).attr('id');
            evnt.duration = $('duration', eventDom).text();
            evnt.title = $('title', eventDom).text();
            evnt.subtitle = $('subtitle', eventDom).text();
            $('person', eventDom).each(function(index, personDom) {
              var person;
              person = _this.typeaheadStrings.push($(personDom).text());
              console.log($.inArray(person, _this.typeaheadStrings));
              if (__indexOf.call(_this.typeaheadStrings, person) < 0) {
                return _this.typeaheadStrings.push($(personDom).text());
              }
            });
            _this.typeaheadStrings.push(evnt.title);
            _this.typeaheadStrings.push(evnt.title);
            return _this.events.push(evnt);
          });
        },
        async: true
      });
    };

    FiveC3.prototype.resizeSidebar = function() {
      return $('#sidebarContent').height($(window).height() - 80);
    };

    return FiveC3;

  })();

  $(document).ready(function() {
    return top.fiveC3 = new FiveC3();
  });

}).call(this);
